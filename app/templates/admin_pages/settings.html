<!DOCTYPE html>
<html lang="en">
  <head>
    {% include "admin_pages/includes/headerContent.html" %}
  </head>

  <body class="nav-md">
    <div class="container body">
      <div class="main_container">
        
        {% include "admin_pages/includes/leftNav.html" %}

        {% include "admin_pages/includes/topNav.html" %}

        <!-- page content -->
        <div class="right_col" role="main">
          <div class="">
            <div class="clearfix"></div>
            <div class="row">
              <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                  <div class="x_title">
                    <h2>Modify settings</h2>
                    <div class="clearfix"></div>
                  </div>
                  <div class="x_content">
                    <br />
                    <table class="table" id="formHolder">
                      <thead>
                        <tr>
                            <th>Setting</th>
                            <th>Input</th>
                            <th>Update</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <th>Admin password</th>
                          <th>
                            <div class="form-group">
                              <input type="password" class="form-control" id="password" value="" />
                            </div>
                          </th>
                          <th>
                            <button class="btn btn-primary" id="passwordButton">Update</button>
                          </th>
                        </tr>
                        <tr>
                          <th>Maximum guests booked</th>
                          <th>
                            <div class="form-group">
                              <input type="number" class="form-control" id="people" value="{{ people }}" />
                            </div>
                          </th>
                          <th>
                            <button class="btn btn-primary" id="peopleButton">Update</button>
                          </th>
                        </tr>
                        <tr>
                          <th>Phone number</th>
                          <th>
                            <div class="form-group">
                              <input type="phone" class="form-control" id="phone" value="{{ phone }}" />
                            </div>
                          </th>
                          <th>
                            <button class="btn btn-primary" id="phoneButton">Update</button>
                          </th>
                        </tr>
                        <tr>
                          <th>Email</th>
                          <th>
                            <div class="form-group">
                              <input type="text" class="form-control" id="email" value="{{ email }}" />
                            </div>
                          </th>
                          <th>
                            <button class="btn btn-primary" id="emailButton">Update</button>
                          </th>
                        </tr>
                      </tbody>
                    </table>
                </div>
              </div>
            </div>

            
              </div>
            </div>
          </div>
        </div>
        <!-- /page content -->

        {% include "admin_pages/includes/footer.html" %}

      </div>
    </div>

    {% include "admin_pages/includes/scripts.html" %}
    <script>
    $("#passwordButton").click(function() {
      if (!$("#password").val()) {
        new PNotify({
          title: 'Failure',
          text: 'That is not a valid password.',
          type: 'error',
          styling: 'bootstrap3'
        });
        return;
      }

      $.post("/admin/api/updatepassword", {password: $("#password").val()}, function(data) {
        if (data == "true") {
          new PNotify({
              title: 'Success',
              text: 'The password was updated successfully!',
              type: 'success',
              styling: 'bootstrap3'
          });
          } else {
              new PNotify({
                  title: 'Failure',
                  text: 'The password was not updated.',
                  type: 'error',
                  styling: 'bootstrap3'
              });
          }
      })
    })

    $("#peopleButton").click(function() {
      if (!$("#people").val()) {
        new PNotify({
          title: 'Failure',
          text: 'That is not a valid number.',
          type: 'error',
          styling: 'bootstrap3'
        });
        return;
      }

      $.post("/admin/api/updatepeople", {people: $("#people").val()}, function(data) {
        if (data == "true") {
          new PNotify({
              title: 'Success',
              text: 'The maximum guests booked was updated successfully!',
              type: 'success',
              styling: 'bootstrap3'
          });
          } else {
              new PNotify({
                  title: 'Failure',
                  text: 'The maximum guests booked was not updated.',
                  type: 'error',
                  styling: 'bootstrap3'
              });
          }
      })
    })

    $("#phoneButton").click(function() {
      if (!$("#phone").val().match(/^[(]{0,1}[0-9]{3}[)]{0,1}[-\s\.]{0,1}[0-9]{3}[-\s\.]{0,1}[0-9]{4}$/)) {
        new PNotify({
          title: 'Failure',
          text: 'That is not a valid phone number.',
          type: 'error',
          styling: 'bootstrap3'
        });
        return;
      }

      $.post("/admin/api/updatephone", {phone: $("#phone").val()}, function(data) {
        if (data == "true") {
          new PNotify({
              title: 'Success',
              text: 'The phone number was updated successfully!',
              type: 'success',
              styling: 'bootstrap3'
          });
          } else {
              new PNotify({
                  title: 'Failure',
                  text: 'The phone number was not updated.',
                  type: 'error',
                  styling: 'bootstrap3'
              });
          }
      })
    })

    $("#emailButton").click(function() {
      var emailRegex = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
      if (!emailRegex.test($("#email").val())) {
        new PNotify({
          title: 'Failure',
          text: 'That is not a valid email.',
          type: 'error',
          styling: 'bootstrap3'
        });
        return;
      }

      $.post("/admin/api/updateemail", {email: $("#email").val()}, function(data) {
        if (data == "true") {
          new PNotify({
              title: 'Success',
              text: 'The email was updated successfully!',
              type: 'success',
              styling: 'bootstrap3'
          });
          } else {
              new PNotify({
                  title: 'Failure',
                  text: 'The email was not updated.',
                  type: 'error',
                  styling: 'bootstrap3'
              });
          }
      })
    })
    </script>
  </body>
</html>